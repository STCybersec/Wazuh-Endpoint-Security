# ğŸ“„ Wazuh Vulnerability Detection - Analyst Narrative
### ğŸ“Œ Overview

This document provides a detailed narrative of the vulnerability detection phase performed using Wazuh. The purpose of this analysis is to demonstrate the capability of Wazuh to identify operating system and application vulnerabilities, calculate risk exposure, and assist with remediation planning in a corporate environment.

The environment analyzed:

- Host: LT-CoE1
- Operating System: Microsoft Windows 11 Enterprise (Build 22621.6060)
- Total Vulnerabilities Detected: 249
- Severity Breakdown:
- Critical: 46
- High: 105
- Medium: 93
- Low: 3
- Pending Evaluation: 2

These results were obtained using the Wazuh Syscollector inventory module and the Vulnerability Detector module, configured to scan software, OS packages, and security advisories from multiple sources.

## ğŸ“Š Dashboard Summary

Below is a summary of what is represented in the screenshots:

### âœ” Vulnerability Score Distribution

The Wazuh dashboard revealed several CVEs in the 9.0+ range, placing them in the Critical severity category. A significant portion of the vulnerabilities fall between 7.0-8.9, representing High-risk exposures.

### âœ” Most Vulnerable Applications

- Mozilla Firefox (x64 en-US) - 236 detections
- Lenovo System Update - 4 detections
- Python 3.12.4 (64-bit) - 4 detections
- Microsoft Teams Classic - 2 detections
- pip â€“ 2 detections

This demonstrates that the majority of risk comes from third-party applications rather than the OS itself.

### âœ” Vulnerabilities by OS Family

Windows vulnerabilities dominated, with nearly all 249 detections attributed to this single host.

### âœ” Vulnerabilities by Publication Year

There is a spread across multiple years, including CVEs from:

- 2025 (current year)
- 2023
- 2022
- 2020

This indicates the presence of outdated software susceptible to old, well-documented exploits.

### ğŸ›  Detection Configuration Summary

The Syscollector and Vulnerability Detector modules were enabled and tuned appropriately. These modules collected:

- Installed software (name, version, vendor)
- OS version and build
- Hardware inventory
- Running processes
- Software vendor advisories
- Microsoft Security Advisories (MSA)
- Multiple CVE feeds
- A screenshot (syscollector-config.png) shows these configurations as part of the project.

### ğŸ” CVE Spotlight Analysis

Below is a detailed breakdown of one of the high-impact vulnerabilities detected, based on your exploitation-risk screenshot.

### ğŸ›‘ CVE-2022-4568 - Lenovo System Update Privilege Escalation

- Severity: High (7.8 CVSS v3.1)
- Published: 2023-05-01
- Attack Vector: Local
- Attack Complexity: Low
- Privileges Required: Low
- User Interaction: None
- Impact:
  
- Confidentiality: High
- Integrity: High
- Availability: High

### ğŸ“¥ Affected Software

- Lenovo System Update
- Versions up to 5.08.01.0005 (excluding)

### ğŸ” Description

A directory permissions misconfiguration in Lenovo System Update allows a local attacker to escalate privileges. Because System Update runs with elevated permissions, its mismanaged directory permissions could allow malicious overwrites or code injection â€” enabling a complete takeover of the system.

Why This Matters:
 
- Even though the vulnerability is â€œLocal,â€ its characteristics make it extremely dangerous:
- Low attack complexity
- No user interaction required
- Privilege escalation leads to full control
- All three CIA triad components impacted: C, I, A
- A common target in corporate environments using Lenovo hardware

This vulnerability is ideal for attacker lateral movement and persistence techniques (MITRE ATT&CK T1068 / Privilege Escalation).

### ğŸ“ Additional CVEs Detected (Sample)

Wazuh detected multiple CVEs during the scan, including:

- CVE-2025-8869 (2 instances)
- CVE-2020-8342
- CVE-2022-0354
- CVE-2023-24881

These CVEs affect browsers, firmware utilities, and core components of Windows 11.

### A supporting screenshot has been saved as:

docs/cve-detections.png

### ğŸ§© Risk Interpretation

Based on the vulnerability distribution:

### ğŸ”¥ Immediate Remediation Priority

- Critical CVEs (46 instances)
- High Severity CVEs (105 instances)
- These put the environment at risk for:
- Remote code execution
- Local privilege escalation
- Credential theft
- Persistence installation
- Browser-based exploit chains

### ğŸŸ¡ Medium & Low Risks

These should still be remediated but do not require emergency response unless part of a known exploit chain.

### ğŸ›¡ Recommended Remediation Strategy
**âœ” 1. Patch Lenovo System Update**

Download the latest version > 5.08.01.0005.

**âœ” 2. Update Firefox Immediately**

236 vulnerabilities were linked to Firefox. Update to the newest ESR version recommended for enterprise deployments.

**âœ” 3. Review OS Patch Status**

- Verify Windows Update baseline:
- Install latest cumulative updates
- Validate security catalog signatures

**âœ” 4. Remove Unneeded Software**

- Python, pip, and Teams showed vulnerabilities.
- If not business-critical, remove or isolate.

**âœ” 5. Re-run Wazuh Scans**

After patching:

- Trigger a forced syscollector scan
- Trigger vulnerability-detector
- Validate remediation

### ğŸ§ª Validation Through Wazuh

- Validation logs and screenshots show:
- Initial vulnerability count before remediation
- Confirmed CVE matches
- Risk categorization
- Exploitability metrics
- This creates a legitimate SOC investigation trail.

### ğŸ Conclusion

The Wazuh Vulnerability Detector effectively identified system weaknesses across the environment. The large number of High and Critical vulnerabilities highlights the importance of continuous monitoring and timely patch management.

This narrative, combined with dashboard evidence and CVE screenshots, demonstrates full understanding of:

- Vulnerability discovery
- CVE interpretation
- Exploit impact analysis
- SOC-level remediation
- Wazuh configuration and detection pipeline
